2023-04-19 04:55:21.619 | INFO     | __main__:setup_files:218 - Experiment Name: OFFICIAL_RUN
2023-04-19 04:55:21.621 | INFO     | __main__:main:334 - Command line arguments: Configuration(algorithm='der', dataset='cifar10', classes_per_task=2, seed=2214, samples=2000)
2023-04-19 04:55:21.623 | INFO     | __main__:main:338 - Seeded random to 2214
2023-04-19 04:55:21.624 | INFO     | __main__:main:342 - Got CUDA device
2023-04-19 04:55:21.625 | INFO     | __main__:force_cuda_load:268 - Forcing CUDA initialisation...
2023-04-19 04:55:21.682 | INFO     | __main__:main:346 - CUDA initialised
2023-04-19 04:55:21.683 | INFO     | __main__:setup_shutdown_hook:264 - To access TensorBoard, run the command: tensorboard --logdir=./output_cifar10_varied_sampling/der_pp/1681876521.601778_CIFAR10_OFFICIAL_RUN
2023-04-19 04:55:21.685 | INFO     | __main__:main:350 - Setup shutdown hooks
2023-04-19 04:55:21.809 | INFO     | __main__:main:355 - Model is setup
2023-04-19 04:55:21.810 | INFO     | __main__:main:357 - Complete pre-setup, starting experiment
2023-04-19 04:55:23.035 | INFO     | datasets.dataset_base:__init__:80 - Using disjoint tasks with 2 (5 tasks) with a randomised split
2023-04-19 04:55:23.036 | DEBUG    | datasets.dataset_base:_setup_task_datasets:95 - Splitting dataset into 5 disjoint tasks
2023-04-19 04:55:23.056 | INFO     | datasets.dataset_base:__init__:85 - {
  "name": "datasets.cifar10.CIFAR10",
  "dataset_class": "torchvision.datasets.cifar.CIFAR10",
  "training_dataset_parameters": "{'train': True, 'download': True}",
  "testing_dataset_parameters": "{'train': False, 'download': True}",
  "training_transform": "Compose(\n    Resize(size=(32, 32), interpolation=bilinear, max_size=None, antialias=None)\n    ToTensor()\n    Normalize(mean=(0.4914, 0.4822, 0.4465), std=(0.247, 0.2435, 0.2616))\n    RandomCrop(size=(32, 32), padding=4)\n    RandomHorizontalFlip(p=0.5)\n)",
  "testing_transform": "Compose(\n    Resize(size=(32, 32), interpolation=bilinear, max_size=None, antialias=None)\n    ToTensor()\n    Normalize(mean=(0.4914, 0.4822, 0.4465), std=(0.247, 0.2435, 0.2616))\n)",
  "classes": "plane, car, bird, cat, deer, dog, frog, horse, ship, truck",
  "disjoint": true,
  "task_count": 5,
  "classes_per_task": [
    2
  ],
  "task_split_indices": [
    [
      2,
      0
    ],
    [
      6,
      9
    ],
    [
      5,
      8
    ],
    [
      3,
      1
    ],
    [
      7,
      4
    ]
  ],
  "task_split_classes": [
    [
      "bird",
      "plane"
    ],
    [
      "frog",
      "truck"
    ],
    [
      "dog",
      "ship"
    ],
    [
      "cat",
      "car"
    ],
    [
      "horse",
      "deer"
    ]
  ]
}
2023-04-19 04:55:23.061 | DEBUG    | __main__:run_experiment:292 - PID: 10820
2023-04-19 04:55:23.062 | INFO     | __main__:run_experiment:294 - Starting...
2023-04-19 04:55:23.063 | INFO     | algorithms.algorithm_base:train:116 - {
  "name": "algorithms.der_pp.DarkExperiencePlusPlus",
  "model_class": "models.cifar.resnet.ResNet",
  "device": "cuda:0",
  "dataset_class": "datasets.cifar10.CIFAR10",
  "optimiser_class": "torch.optim.sgd.SGD",
  "loss_criterion_class": "torch.nn.modules.loss.CrossEntropyLoss",
  "epochs_per_task": 1,
  "batch_size": 16,
  "max_memory_samples": 2000,
  "alpha": 0.5,
  "beta": 0
}
2023-04-19 04:55:23.064 | DEBUG    | algorithms.algorithm_base:_setup_training:109 - Model moved to cuda:0 and set to train mode
2023-04-19 04:55:23.065 | INFO     | algorithms.algorithm_base:train:118 - Starting training
2023-04-19 04:55:23.066 | INFO     | algorithms.der_pp:train:86 - Task 1 / 5
2023-04-19 04:55:23.067 | INFO     | algorithms.der_pp:train:87 - Classes in task: ['bird', 'plane']
2023-04-19 04:55:23.068 | INFO     | algorithms.der_pp:train:95 - Starting epoch 1 / 1
2023-04-19 04:55:28.315 | INFO     | algorithms.der_pp:train:159 - 0:1:40, loss: 2.509
2023-04-19 04:55:30.916 | INFO     | algorithms.der_pp:train:159 - 0:1:80, loss: 2.109
2023-04-19 04:55:33.524 | INFO     | algorithms.der_pp:train:159 - 0:1:120, loss: 1.889
2023-04-19 04:55:36.143 | INFO     | algorithms.der_pp:train:159 - 0:1:160, loss: 1.781
2023-04-19 04:55:38.763 | INFO     | algorithms.der_pp:train:159 - 0:1:200, loss: 1.605
2023-04-19 04:55:41.384 | INFO     | algorithms.der_pp:train:159 - 0:1:240, loss: 1.546
2023-04-19 04:55:43.999 | INFO     | algorithms.der_pp:train:159 - 0:1:280, loss: 1.493
2023-04-19 04:55:46.623 | INFO     | algorithms.der_pp:train:159 - 0:1:320, loss: 1.391
2023-04-19 04:55:49.246 | INFO     | algorithms.der_pp:train:159 - 0:1:360, loss: 1.213
2023-04-19 04:55:51.865 | INFO     | algorithms.der_pp:train:159 - 0:1:400, loss: 1.205
2023-04-19 04:55:54.485 | INFO     | algorithms.der_pp:train:159 - 0:1:440, loss: 1.139
2023-04-19 04:55:57.106 | INFO     | algorithms.der_pp:train:159 - 0:1:480, loss: 1.158
2023-04-19 04:55:59.737 | INFO     | algorithms.der_pp:train:159 - 0:1:520, loss: 1.130
2023-04-19 04:56:02.364 | INFO     | algorithms.der_pp:train:159 - 0:1:560, loss: 1.053
2023-04-19 04:56:04.988 | INFO     | algorithms.der_pp:train:159 - 0:1:600, loss: 1.030
2023-04-19 04:56:06.562 | DEBUG    | algorithms.der_pp:train:162 - Current sample stats:
2023-04-19 04:56:06.563 | DEBUG    | algorithms.der_pp:train:165 - 2 has 1000 samples
2023-04-19 04:56:06.564 | DEBUG    | algorithms.der_pp:train:165 - 0 has 1000 samples
2023-04-19 04:56:06.564 | INFO     | algorithms.der_pp:train:170 - 1, loss: 1.464
2023-04-19 04:56:06.565 | INFO     | algorithms.algorithm_base:run_base_task_metrics:144 - Running metrics: Task 0
2023-04-19 04:56:11.430 | DEBUG    | algorithms.algorithm_base:run_base_task_metrics:200 - Raw classification accuracy results saved to ./output_cifar10_varied_sampling/der_pp/1681876521.601778_CIFAR10_OFFICIAL_RUN/task_0_accuracy_results.json
2023-04-19 04:56:11.431 | INFO     | algorithms.algorithm_base:run_base_task_metrics:201 - Correctly classified 1627 / 10000 samples (16.27% correct)
2023-04-19 04:56:11.663 | INFO     | algorithms.der_pp:train:86 - Task 2 / 5
2023-04-19 04:56:11.668 | INFO     | algorithms.der_pp:train:87 - Classes in task: ['frog', 'truck']
2023-04-19 04:56:11.668 | INFO     | algorithms.der_pp:train:95 - Starting epoch 1 / 1
2023-04-19 04:56:14.362 | INFO     | algorithms.der_pp:train:159 - 1:1:40, loss: 3.086
2023-04-19 04:56:16.989 | INFO     | algorithms.der_pp:train:159 - 1:1:80, loss: 2.543
2023-04-19 04:56:19.610 | INFO     | algorithms.der_pp:train:159 - 1:1:120, loss: 2.163
2023-04-19 04:56:22.226 | INFO     | algorithms.der_pp:train:159 - 1:1:160, loss: 1.937
2023-04-19 04:56:24.842 | INFO     | algorithms.der_pp:train:159 - 1:1:200, loss: 1.785
2023-04-19 04:56:27.465 | INFO     | algorithms.der_pp:train:159 - 1:1:240, loss: 1.575
2023-04-19 04:56:30.085 | INFO     | algorithms.der_pp:train:159 - 1:1:280, loss: 1.482
2023-04-19 04:56:32.704 | INFO     | algorithms.der_pp:train:159 - 1:1:320, loss: 1.345
2023-04-19 04:56:35.326 | INFO     | algorithms.der_pp:train:159 - 1:1:360, loss: 1.249
2023-04-19 04:56:37.948 | INFO     | algorithms.der_pp:train:159 - 1:1:400, loss: 1.314
2023-04-19 04:56:40.576 | INFO     | algorithms.der_pp:train:159 - 1:1:440, loss: 1.125
2023-04-19 04:56:43.206 | INFO     | algorithms.der_pp:train:159 - 1:1:480, loss: 1.094
2023-04-19 04:56:45.836 | INFO     | algorithms.der_pp:train:159 - 1:1:520, loss: 1.044
2023-04-19 04:56:48.489 | INFO     | algorithms.der_pp:train:159 - 1:1:560, loss: 1.025
2023-04-19 04:56:51.114 | INFO     | algorithms.der_pp:train:159 - 1:1:600, loss: 1.015
2023-04-19 04:56:52.691 | DEBUG    | algorithms.der_pp:train:162 - Current sample stats:
2023-04-19 04:56:52.692 | DEBUG    | algorithms.der_pp:train:165 - 2 has 500 samples
2023-04-19 04:56:52.693 | DEBUG    | algorithms.der_pp:train:165 - 0 has 500 samples
2023-04-19 04:56:52.694 | DEBUG    | algorithms.der_pp:train:165 - 9 has 500 samples
2023-04-19 04:56:52.694 | DEBUG    | algorithms.der_pp:train:165 - 6 has 500 samples
2023-04-19 04:56:52.695 | INFO     | algorithms.der_pp:train:170 - 1, loss: 1.563
2023-04-19 04:56:52.696 | INFO     | algorithms.algorithm_base:run_base_task_metrics:144 - Running metrics: Task 1
2023-04-19 04:56:57.403 | DEBUG    | algorithms.algorithm_base:run_base_task_metrics:200 - Raw classification accuracy results saved to ./output_cifar10_varied_sampling/der_pp/1681876521.601778_CIFAR10_OFFICIAL_RUN/task_1_accuracy_results.json
2023-04-19 04:56:57.405 | INFO     | algorithms.algorithm_base:run_base_task_metrics:201 - Correctly classified 2135 / 10000 samples (21.35% correct)
2023-04-19 04:56:57.541 | INFO     | algorithms.der_pp:train:86 - Task 3 / 5
2023-04-19 04:56:57.545 | INFO     | algorithms.der_pp:train:87 - Classes in task: ['dog', 'ship']
2023-04-19 04:56:57.546 | INFO     | algorithms.der_pp:train:95 - Starting epoch 1 / 1
2023-04-19 04:57:00.238 | INFO     | algorithms.der_pp:train:159 - 2:1:40, loss: 3.551
2023-04-19 04:57:02.864 | INFO     | algorithms.der_pp:train:159 - 2:1:80, loss: 2.954
2023-04-19 04:57:05.492 | INFO     | algorithms.der_pp:train:159 - 2:1:120, loss: 2.554
2023-04-19 04:57:08.118 | INFO     | algorithms.der_pp:train:159 - 2:1:160, loss: 2.280
2023-04-19 04:57:10.748 | INFO     | algorithms.der_pp:train:159 - 2:1:200, loss: 2.033
2023-04-19 04:57:13.372 | INFO     | algorithms.der_pp:train:159 - 2:1:240, loss: 1.841
2023-04-19 04:57:15.997 | INFO     | algorithms.der_pp:train:159 - 2:1:280, loss: 1.786
2023-04-19 04:57:18.625 | INFO     | algorithms.der_pp:train:159 - 2:1:320, loss: 1.612
2023-04-19 04:57:21.254 | INFO     | algorithms.der_pp:train:159 - 2:1:360, loss: 1.487
2023-04-19 04:57:23.883 | INFO     | algorithms.der_pp:train:159 - 2:1:400, loss: 1.486
2023-04-19 04:57:26.518 | INFO     | algorithms.der_pp:train:159 - 2:1:440, loss: 1.356
2023-04-19 04:57:29.149 | INFO     | algorithms.der_pp:train:159 - 2:1:480, loss: 1.331
2023-04-19 04:57:31.785 | INFO     | algorithms.der_pp:train:159 - 2:1:520, loss: 1.306
2023-04-19 04:57:34.411 | INFO     | algorithms.der_pp:train:159 - 2:1:560, loss: 1.242
2023-04-19 04:57:37.043 | INFO     | algorithms.der_pp:train:159 - 2:1:600, loss: 1.223
2023-04-19 04:57:38.623 | DEBUG    | algorithms.der_pp:train:162 - Current sample stats:
2023-04-19 04:57:38.624 | DEBUG    | algorithms.der_pp:train:165 - 2 has 333 samples
2023-04-19 04:57:38.625 | DEBUG    | algorithms.der_pp:train:165 - 0 has 333 samples
2023-04-19 04:57:38.626 | DEBUG    | algorithms.der_pp:train:165 - 9 has 333 samples
2023-04-19 04:57:38.626 | DEBUG    | algorithms.der_pp:train:165 - 6 has 333 samples
2023-04-19 04:57:38.627 | DEBUG    | algorithms.der_pp:train:165 - 8 has 334 samples
2023-04-19 04:57:38.628 | DEBUG    | algorithms.der_pp:train:165 - 5 has 334 samples
2023-04-19 04:57:38.628 | INFO     | algorithms.der_pp:train:170 - 1, loss: 1.845
2023-04-19 04:57:38.629 | INFO     | algorithms.algorithm_base:run_base_task_metrics:144 - Running metrics: Task 2
2023-04-19 04:57:43.400 | DEBUG    | algorithms.algorithm_base:run_base_task_metrics:200 - Raw classification accuracy results saved to ./output_cifar10_varied_sampling/der_pp/1681876521.601778_CIFAR10_OFFICIAL_RUN/task_2_accuracy_results.json
2023-04-19 04:57:43.401 | INFO     | algorithms.algorithm_base:run_base_task_metrics:201 - Correctly classified 2701 / 10000 samples (27.01% correct)
2023-04-19 04:57:43.537 | INFO     | algorithms.der_pp:train:86 - Task 4 / 5
2023-04-19 04:57:43.541 | INFO     | algorithms.der_pp:train:87 - Classes in task: ['cat', 'car']
2023-04-19 04:57:43.542 | INFO     | algorithms.der_pp:train:95 - Starting epoch 1 / 1
2023-04-19 04:57:46.243 | INFO     | algorithms.der_pp:train:159 - 3:1:40, loss: 3.867
2023-04-19 04:57:48.871 | INFO     | algorithms.der_pp:train:159 - 3:1:80, loss: 3.060
2023-04-19 04:57:51.503 | INFO     | algorithms.der_pp:train:159 - 3:1:120, loss: 2.679
2023-04-19 04:57:54.136 | INFO     | algorithms.der_pp:train:159 - 3:1:160, loss: 2.436
2023-04-19 04:57:56.771 | INFO     | algorithms.der_pp:train:159 - 3:1:200, loss: 2.157
2023-04-19 04:57:59.403 | INFO     | algorithms.der_pp:train:159 - 3:1:240, loss: 2.014
2023-04-19 04:58:02.032 | INFO     | algorithms.der_pp:train:159 - 3:1:280, loss: 1.827
2023-04-19 04:58:04.656 | INFO     | algorithms.der_pp:train:159 - 3:1:320, loss: 1.786
2023-04-19 04:58:07.286 | INFO     | algorithms.der_pp:train:159 - 3:1:360, loss: 1.730
2023-04-19 04:58:09.916 | INFO     | algorithms.der_pp:train:159 - 3:1:400, loss: 1.631
2023-04-19 04:58:12.543 | INFO     | algorithms.der_pp:train:159 - 3:1:440, loss: 1.547
2023-04-19 04:58:15.169 | INFO     | algorithms.der_pp:train:159 - 3:1:480, loss: 1.498
2023-04-19 04:58:17.800 | INFO     | algorithms.der_pp:train:159 - 3:1:520, loss: 1.463
2023-04-19 04:58:20.427 | INFO     | algorithms.der_pp:train:159 - 3:1:560, loss: 1.446
2023-04-19 04:58:23.056 | INFO     | algorithms.der_pp:train:159 - 3:1:600, loss: 1.432
2023-04-19 04:58:24.634 | DEBUG    | algorithms.der_pp:train:162 - Current sample stats:
2023-04-19 04:58:24.635 | DEBUG    | algorithms.der_pp:train:165 - 2 has 250 samples
2023-04-19 04:58:24.635 | DEBUG    | algorithms.der_pp:train:165 - 0 has 250 samples
2023-04-19 04:58:24.636 | DEBUG    | algorithms.der_pp:train:165 - 9 has 250 samples
2023-04-19 04:58:24.637 | DEBUG    | algorithms.der_pp:train:165 - 6 has 250 samples
2023-04-19 04:58:24.638 | DEBUG    | algorithms.der_pp:train:165 - 8 has 250 samples
2023-04-19 04:58:24.638 | DEBUG    | algorithms.der_pp:train:165 - 5 has 250 samples
2023-04-19 04:58:24.639 | DEBUG    | algorithms.der_pp:train:165 - 3 has 250 samples
2023-04-19 04:58:24.640 | DEBUG    | algorithms.der_pp:train:165 - 1 has 250 samples
2023-04-19 04:58:24.641 | INFO     | algorithms.der_pp:train:170 - 1, loss: 2.016
2023-04-19 04:58:24.641 | INFO     | algorithms.algorithm_base:run_base_task_metrics:144 - Running metrics: Task 3
2023-04-19 04:58:29.398 | DEBUG    | algorithms.algorithm_base:run_base_task_metrics:200 - Raw classification accuracy results saved to ./output_cifar10_varied_sampling/der_pp/1681876521.601778_CIFAR10_OFFICIAL_RUN/task_3_accuracy_results.json
2023-04-19 04:58:29.400 | INFO     | algorithms.algorithm_base:run_base_task_metrics:201 - Correctly classified 2606 / 10000 samples (26.06% correct)
2023-04-19 04:58:29.536 | INFO     | algorithms.der_pp:train:86 - Task 5 / 5
2023-04-19 04:58:29.540 | INFO     | algorithms.der_pp:train:87 - Classes in task: ['horse', 'deer']
2023-04-19 04:58:29.541 | INFO     | algorithms.der_pp:train:95 - Starting epoch 1 / 1
2023-04-19 04:58:32.237 | INFO     | algorithms.der_pp:train:159 - 4:1:40, loss: 4.078
2023-04-19 04:58:34.866 | INFO     | algorithms.der_pp:train:159 - 4:1:80, loss: 3.266
2023-04-19 04:58:37.495 | INFO     | algorithms.der_pp:train:159 - 4:1:120, loss: 2.911
2023-04-19 04:58:40.122 | INFO     | algorithms.der_pp:train:159 - 4:1:160, loss: 2.727
2023-04-19 04:58:42.753 | INFO     | algorithms.der_pp:train:159 - 4:1:200, loss: 2.519
2023-04-19 04:58:45.391 | INFO     | algorithms.der_pp:train:159 - 4:1:240, loss: 2.337
2023-04-19 04:58:48.025 | INFO     | algorithms.der_pp:train:159 - 4:1:280, loss: 2.231
2023-04-19 04:58:50.657 | INFO     | algorithms.der_pp:train:159 - 4:1:320, loss: 2.117
2023-04-19 04:58:53.290 | INFO     | algorithms.der_pp:train:159 - 4:1:360, loss: 2.050
2023-04-19 04:58:55.930 | INFO     | algorithms.der_pp:train:159 - 4:1:400, loss: 1.888
2023-04-19 04:58:58.588 | INFO     | algorithms.der_pp:train:159 - 4:1:440, loss: 1.922
2023-04-19 04:59:01.239 | INFO     | algorithms.der_pp:train:159 - 4:1:480, loss: 1.865
2023-04-19 04:59:03.872 | INFO     | algorithms.der_pp:train:159 - 4:1:520, loss: 1.823
2023-04-19 04:59:06.503 | INFO     | algorithms.der_pp:train:159 - 4:1:560, loss: 1.767
2023-04-19 04:59:09.183 | INFO     | algorithms.der_pp:train:159 - 4:1:600, loss: 1.792
2023-04-19 04:59:10.770 | DEBUG    | algorithms.der_pp:train:162 - Current sample stats:
2023-04-19 04:59:10.771 | DEBUG    | algorithms.der_pp:train:165 - 2 has 200 samples
2023-04-19 04:59:10.772 | DEBUG    | algorithms.der_pp:train:165 - 0 has 200 samples
2023-04-19 04:59:10.772 | DEBUG    | algorithms.der_pp:train:165 - 9 has 200 samples
2023-04-19 04:59:10.773 | DEBUG    | algorithms.der_pp:train:165 - 6 has 200 samples
2023-04-19 04:59:10.774 | DEBUG    | algorithms.der_pp:train:165 - 8 has 200 samples
2023-04-19 04:59:10.775 | DEBUG    | algorithms.der_pp:train:165 - 5 has 200 samples
2023-04-19 04:59:10.775 | DEBUG    | algorithms.der_pp:train:165 - 3 has 200 samples
2023-04-19 04:59:10.776 | DEBUG    | algorithms.der_pp:train:165 - 1 has 200 samples
2023-04-19 04:59:10.777 | DEBUG    | algorithms.der_pp:train:165 - 7 has 200 samples
2023-04-19 04:59:10.778 | DEBUG    | algorithms.der_pp:train:165 - 4 has 200 samples
2023-04-19 04:59:10.778 | INFO     | algorithms.der_pp:train:170 - 1, loss: 2.327
2023-04-19 04:59:10.779 | INFO     | algorithms.algorithm_base:run_base_task_metrics:144 - Running metrics: Task 4
2023-04-19 04:59:15.439 | DEBUG    | algorithms.algorithm_base:run_base_task_metrics:200 - Raw classification accuracy results saved to ./output_cifar10_varied_sampling/der_pp/1681876521.601778_CIFAR10_OFFICIAL_RUN/task_4_accuracy_results.json
2023-04-19 04:59:15.440 | INFO     | algorithms.algorithm_base:run_base_task_metrics:201 - Correctly classified 3226 / 10000 samples (32.26% correct)
2023-04-19 04:59:15.576 | INFO     | algorithms.der_pp:train:178 - Training complete
2023-04-19 04:59:15.581 | INFO     | __main__:run_experiment:300 - Training and evaluation completed!
2023-04-19 04:59:15.583 | INFO     | __main__:run_experiment:314 - Wrote usage stats to file
2023-04-19 04:59:15.584 | INFO     | __main__:main:363 - Complete
2023-04-19 04:59:15.584 | INFO     | __main__:close_tensorboard_writer:262 - Shut down TensorBoard
